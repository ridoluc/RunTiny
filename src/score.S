; 
; Registers used: R23, R24, R25, R19


#define W 5

#define tmp R19



.section .data
; ; score_digit_1: .space 3
score_digit_1: .byte 0x00
score_digit_2: .byte 0x00
score_digit_3: .byte 0x00

.section .text
.global print_score

print_score:
    lds  R23, score_digit_1
    subi R23, (-W)
    cpi R23, (W *10)
    brlo store+2            
    ldi R23, 0
    lds R24, score_digit_2
    subi R24, (-W)
    cpi R24, (W *10)
    brlo store
    ldi R24, 0
    lds R25, score_digit_3
    subi R25, (-W)
    sts score_digit_3, R25
store:
    sts score_digit_2, R24
    sts score_digit_1, R23    

    ; Print Digits

    ; TWI Start
    rcall start
    ldi R24, 0x78
    rcall Tx
    ldi R24, 0x40
    rcall Tx

    lds R24, score_digit_3
    rcall print_digit
    lds R24, score_digit_2
    rcall print_digit
    lds R24, score_digit_1
    rcall print_digit
    
    ; TWI Stop
    rcall stop



print_digit:
    ldi R25, 0x00
    ldi ZH, hi8(font_digit)
    ldi ZL, lo8(font_digit)
    add ZL, R24
    adc ZH, R25
    ldi tmp, W-1  ; counter same as digit width
    ld R24, Z+
    rcall Tx
    dec tmp
    brpl .-8
    ldi R24, 0
    rcall Tx
ret




.section .rodata

font_digit: 
    .byte 0x7c,0x82,0x82,0x82,0x7c ;0
    .byte 0x00,0x84,0xfe,0x80,0x00 ;1
    .byte 0x84,0xc2,0xa2,0x92,0x8c ;2
    .byte 0x44,0x82,0x92,0x92,0x6c ;3
    .byte 0x30,0x28,0x24,0xfe,0x20 ;4
    .byte 0x9e,0x92,0x92,0x92,0x60 ;5
    .byte 0x7c,0x92,0x92,0x92,0x60 ;6
    .byte 0x02,0xe2,0x12,0x0a,0x06 ;7
    .byte 0x6c,0x92,0x92,0x92,0x6c ;8
    .byte 0x0c,0x92,0x92,0x92,0x7c ;9

    ; .byte 0x00,0x0e,0x11,0x11,0x0e ;0  ok
    ; .byte 0x00,0x02,0x03,0x1f,0x00 ;1  ok
    ; .byte 0x00,0x19,0x15,0x15,0x17 ;2  ok
    ; .byte 0x00,0x11,0x15,0x15,0x1e ;3  ok
    ; .byte 0x00,0x0c,0x0a,0x1f,0x08 ;4  ok
    ; .byte 0x00,0x16,0x15,0x15,0x1d ;5  ok
    ; .byte 0x00,0x0e,0x15,0x15,0x1d ;6  ok
    ; .byte 0x00,0x01,0x11,0x09,0x06 ;7  ok
    ; .byte 0x00,0x0a,0x15,0x15,0x0a ;8  ok
    ; .byte 0x00,0x06,0x15,0x15,0x0e  ;9  ok



